{
    "MarkdownPaste.applyAllRules": true,
    "MarkdownPaste.lang_rules": [
        {
            // https://github.com/Chaoses-Ib/ib-typ/blob/main/.vscode/settings.json
            "typst": [
                {
                    // Normalize spaces
                    "regex": "Â ",
                    "options": "g",
                    "replace": " "
                },
                {
                    // Do not escape ` (in links)
                    "regex": "\\\\`",
                    "options": "g",
                    "replace": "`"
                },
                {
                    // Escape #, @, $, ~ in links
                    // < is not escaped as it's usually used in code.
                    // document.title = '* _ ` < > @ = - + / $ \\ \' " ~ --- #'
                    // TODO: Don't escape in code block
                    "regex": "[#@$~](?=.*?\\]\\()",
                    "options": "g",
                    // https://github.com/telesoho/vscode-markdown-paste-image/issues/144
                    "replace": "\\$&"
                },
                {
                    // Escape // in links
                    // e.g. https://www.youtube.com/watch?v=6tsNbrUSWuc
                    "regex": "//(?=.*?\\]\\()",
                    "options": "g",
                    "replace": "\\//"
                },
                {
                    // Turn <> in links into code blocks
                    "regex": "[\\x21-\\x7e]*<[\\x21-\\x7e]*>[\\x21-\\x7e]*(?=.*?\\]\\()",
                    "options": "g",
                    "replace": "`$&`"
                },
                {
                    // Deduplicate whole/inline link text and title
                    "regex": "\\[(.*?)\\]\\(<?(.+?)>?( \"\\1\")\\)",
                    "options": "g",
                    "replace": "#a[$1][$2]"
                },
                {
                    // Whole links
                    "regex": "^\\[(.*?)\\]\\(<?(.+)>?( \".*?\")?\\)$",
                    "options": "m",
                    "replace": "#a[$1$3][$2]"
                },
                {
                    // Inline links
                    // TODO: Parentheses are allowed without escaping, as long as they are balanced
                    "regex": "\\[(.*?)\\]\\(<?(.+?)>?( \".*?\")?\\)",
                    "options": "g",
                    "replace": "#a[$1$3][$2]"
                },
            ]
        }
    ]
}